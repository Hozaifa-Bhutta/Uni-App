{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = securityHeadersMiddleware;\n\nfunction securityHeadersMiddleware(req, res, next) {\n  if (typeof req.headers.origin === 'string' && !req.headers.origin.match(/^https?:\\/\\/localhost:/)) {\n    next(new Error('Unauthorized request from ' + req.headers.origin + '. This may happen because of a conflicting browser extension. Please try to disable it and try again.'));\n    return;\n  }\n\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n  next();\n}","map":{"version":3,"sources":["../src/securityHeadersMiddleware.ts"],"names":["req","next","res"],"mappings":";;;;;;;AAQe,SAAA,yBAAA,CAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAIb;EAEA,IACE,OAAOA,GAAG,CAAHA,OAAAA,CAAP,MAAA,KAAA,QAAA,IACA,CAACA,GAAG,CAAHA,OAAAA,CAAAA,MAAAA,CAAAA,KAAAA,CAFH,wBAEGA,CAFH,EAGE;IACAC,IAAI,CACF,IAAA,KAAA,CACE,+BACED,GAAG,CAAHA,OAAAA,CADF,MAAA,GAFJC,uGACE,CADE,CAAJA;IAOA;EAbF;;EAiBAC,GAAG,CAAHA,SAAAA,CAAAA,wBAAAA,EAAAA,SAAAA;EAEAD,IAAI;AACL","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport http from 'http';\n\nexport default function securityHeadersMiddleware(\n  req: http.IncomingMessage,\n  res: http.ServerResponse,\n  next: (err?: any) => void,\n) {\n  // Block any cross origin request.\n  if (\n    typeof req.headers.origin === 'string' &&\n    !req.headers.origin.match(/^https?:\\/\\/localhost:/)\n  ) {\n    next(\n      new Error(\n        'Unauthorized request from ' +\n          req.headers.origin +\n          '. This may happen because of a conflicting browser extension. Please try to disable it and try again.',\n      ),\n    );\n    return;\n  }\n\n  // Block MIME-type sniffing.\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n\n  next();\n}\n"]},"metadata":{},"sourceType":"script"}